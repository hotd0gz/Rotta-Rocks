---
description: >-
  Cross-site request forgery (CSRF) allows an attacker to induce users to
  perform actions that they do not intend to perform
---

# Cross-Site Request Forgery (CSRF)

**Note**

Although CSRF is normally described in relation to cookie-based session handling, it also arises in other contexts where the application automatically adds some user credentials to requests, such as HTTP Basic authentication and certificate-based authentication.





**Fo**_**r example:**_ This web page once viewed, changes the email for a user on "https://vuln-site.com"

<pre class="language-html"><code class="lang-html"><strong>&#x3C;html>
</strong>    &#x3C;body>
        &#x3C;form action="https:vuln-site.com/change-email" method="POST">
            &#x3C;input type="hidden" name="email" value="pwned1@evil.net" />
        &#x3C;/form>
        &#x3C;script>
            document.forms[0].submit();
        &#x3C;/script>
    &#x3C;/body>
&#x3C;/html>
</code></pre>





### CSRF Delivery

The delivery mechanism for CSRF attacks are essentially the same as reflected XSS. The attacker will place malicious HTML onto a web site they control, and then induce the victim to visit that web page.

Some empy that GET methods can be fully self-contained with a single URL:

```
<img src="https://vuln-site.com/email/change?email=pwned@evil-user.net">
```







### CSRF Defenses

* **CSRF tokens** - A CSRF token is a unique, secret, and unpredictable value that is generated by the server-side application and shared with the client. When attempting to perform a sensitive action, such as submitting a form, the client must include the correct CSRF token in the request. This makes it very difficult for an attacker to construct a valid request on behalf of the victim.
* **SameSite cookies** - SameSite is a browser security mechanism that determines when a website's cookies are included in requests originating from other websites. As requests to perform sensitive actions typically require an authenticated session cookie, the appropriate SameSite restrictions may prevent an attacker from triggering these actions cross-site. Since 2021, Chrome enforces `Lax` SameSite restrictions by default. As this is the proposed standard, we expect other major browsers to adopt this behavior in future.
* **Referer-based validation** - Some applications make use of the HTTP Referer header to attempt to defend against CSRF attacks, normally by verifying that the request originated from the application's own domain. This is generally less effective than CSRF token validation.







### Common Flaws In CSRF Token Validation

Some applications correctly validate the CSRF token when requests use the POST method but skip the validation when the GET method is used.
