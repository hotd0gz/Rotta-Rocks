# Data Directories & Section Headers

## Introduction

What is a Data Directory? A Data Directory is as piece of data located within one of the sections within a PE file.&#x20;

<mark style="color:yellow;">**Data Directories contain useful information needed by the loader, an example is the Import Directory, which contains a list external functions imported from other libraries.]**</mark>

<mark style="color:red;">**IMPORTANT:**</mark> Not all Data Directories have the same structure, the `IMAGE_DATA_DIRECTORY.VirtualAddress`, however the type of that directory is what determines how the chunk of data is parsed.

## Data Directories

The last member of the IMAGE\_OPTIONAL\_HEADER structure is an array of IMAGE\_DATA\_DIRECTORY structures. Defined below:

```c
IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];
```

`IMAGE_NUMBEROF_DIRECTORY_ENTRIES` is a constant defined with the value of `16`, meaning this array can hold up to **16** `IMAGE_DATA_DIRECTORY` directories.

```c
#define IMAGE_NUMBEROF_DIRECTORY_ENTRIES    16
```

`IMAGE_DATA_DIRECTORY` is shown below

```c
typedef struct _IMAGE_DATA_DIRECTORY {
    DWORD   VirtualAddress;
    DWORD   Size;
} IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;
```

The first variable is the RVA pointing to the start of the Data Directory, and the second is the size of the Data Directory.

### Directory Entries

Hereâ€™s a list of Data Directories defined in `winnt.h`. (Each one of these values represents an index in the DataDirectory array):

```c
// Directory Entries

#define IMAGE_DIRECTORY_ENTRY_EXPORT          0   // Export Directory
#define IMAGE_DIRECTORY_ENTRY_IMPORT          1   // Import Directory
#define IMAGE_DIRECTORY_ENTRY_RESOURCE        2   // Resource Directory
#define IMAGE_DIRECTORY_ENTRY_EXCEPTION       3   // Exception Directory
#define IMAGE_DIRECTORY_ENTRY_SECURITY        4   // Security Directory
#define IMAGE_DIRECTORY_ENTRY_BASERELOC       5   // Base Relocation Table
#define IMAGE_DIRECTORY_ENTRY_DEBUG           6   // Debug Directory
//      IMAGE_DIRECTORY_ENTRY_COPYRIGHT       7   // (X86 usage)
#define IMAGE_DIRECTORY_ENTRY_ARCHITECTURE    7   // Architecture Specific Data
#define IMAGE_DIRECTORY_ENTRY_GLOBALPTR       8   // RVA of GP
#define IMAGE_DIRECTORY_ENTRY_TLS             9   // TLS Directory
#define IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG    10   // Load Configuration Directory
#define IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT   11   // Bound Import Directory in headers
#define IMAGE_DIRECTORY_ENTRY_IAT            12   // Import Address Table
#define IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT   13   // Delay Load Import Descriptors
#define IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR 14   // COM Runtime descriptor
```

Here is how it looks in PE Bear

<figure><img src="../../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>



## Sections and Section Headers

### Sections

Sections are the containers of the actual data of an executable file. They occupy the rest of the PE file after the headers, precisely after the section headers.

* **.text**: Contains the executable code of the program.
* **.data**: Contains the initialized data.
* **.bss**: Contains the uninitialized data.
* **.rdata**: Contains read-only initialized data.
* **.edata**: Contains export tables.
* **.idata**: Contains import tables.
* **.reloc**: Contains image relocation information.
* **.rsrc**: Contains resources used by the program. (Images, icons, embedded binaries).
* **.tls**: (Thread Local Storage), provides storage for every executing thread of the program.



### Section Headers

