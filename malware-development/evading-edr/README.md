---
description: >-
  I'll try to keep this section's focus on the most-modern methods for evading
  EDR.
---

# Evading EDR

## References

Here are some fantastic articles that I've discovered throughout my research into EDR's.

{% embed url="https://synzack.github.io/Blinding-EDR-On-Windows/" %}

{% embed url="https://www.microsoft.com/en-us/security/blog/2022/06/30/using-process-creation-properties-to-catch-evasion-techniques/" %}

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1).png" alt=""><figcaption><p>Taken from Microsoft's Blog (Link above)</p></figcaption></figure>



## The EDR Process

EDR's work by utilizing kernel callbacks to inject Hooks into newly created processes. Here's how it works:&#x20;

<figure><img src="../../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

To determine what the file is about to execute as a process, the antimalware engine scans the file’s content at the time of process creation through a process creation callback. Antimalware engines also scan freshly edited files once a handle to that file has been closed.







## Kernel Callback Functions

{% embed url="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nf-ntddk-pssetcreateprocessnotifyroutineex?redirectedfrom=MSDN" %}
On Process Creation
{% endembed %}

Process creation notification isn’t invoked right when a process creation API is called, but rather when the first thread is inserted into a process.

{% embed url="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nf-ntddk-pssetloadimagenotifyroutine" %}
On Image Load (DLL or EXE)
{% endembed %}
